[{"blogurl": "http://ggorjan.blogspot.com\n", "blogroll": [], "title": "Gregor Gorjanc (gg)"}, {"content": ["See here ."], "link": "http://feedproxy.google.com/~r/GregorGorjancsBlog/~3/GPacG0t3NbQ/awk-one-liners.html", "bloglinks": {}, "links": {"http://nixshell.wordpress.com/": 1}, "blogtitle": "Gregor Gorjanc (gg)"}, {"content": ["Reliability of breeding values in selected populations \n\n Partitioning International Genetic Trends by Origin in Holstein bulls"], "link": "http://feedproxy.google.com/~r/GregorGorjancsBlog/~3/rDo6_E83LYc/interbull-and-icar-papers.html", "bloglinks": {}, "links": {"http://www.scribd.com/": 2}, "blogtitle": "Gregor Gorjanc (gg)"}, {"content": ["This is the presentation (and abstract bellow) of my talk at local congress Genetika 2012 . \n Whole-genome evaluation of complex traits using SNP, haplotype, or QTL information \n\n \n \nAbstract: \n \n \n Whole-genome\ntechnologies provide rich data for\ndissection of complex traits. While gene discovery is still largely\nlimited, the data at hand can be successfully used for evaluation of\ngenetic merit. The aim of this work was to demonstrate the value of\ndifferent sources of information (pedigrees, Single Nucleotide\nPolymorphisms \u2013 SNP, haplotypes, or Quantitative Trait Loci \u2013\nQTL) for genetic evaluation of non-phenotyped individuals in a\ntypical animal breeding scenario via simulation. In the first step a\ncoalescent simulation was used to create a base population with\nstructured chromosomes that were in the second step dropped and\nrecombined through the pedigree of 10 generations with 50 sires per\ngeneration, 10 dams per sire, and 2 offspring per dam. Phenotypic\nvalues were simulated with different genetic architectures (QTL\neffects were sampled from Gaussian or gamma distribution and minor\nallele frequency less than 0.3) and heritability of 0.25. Genotypic\ndata was available for all individuals from generation 4 onwards,\nwhile phenotypic data was available for individuals in generations 4\nand 5. Genetic evaluation was based on linear mixed models with\nrelationship matrix between individuals. This matrix was built using\npedigree, SNP, haplotype, or QTL data. Haplotypes of different length\nwere considered (from 5 to all the way up to 2000 SNP) with an option\nto account for similarities between haplotypes while building\nrelationship matrices. The accuracy of different methods was assessed\nby correlation between true and evaluated additive genetic values for\nindividuals in generations 6, 8 and 10. Average accuracy over ten\nreplications for Gaussian trait over generations was between 0.45 to\n0.10 for pedigree data, 0.50 to 0.35 for SNP and haplotype data and\n0.6 to 0.4 for QTL data. In the case of long haplotypes accuracies\ndropped considerably, but accounting for similarities between\nhaplotypes prevented this drop. In the case of gamma trait accuracies\nwere slightly higher in generation 6 and dropped faster in the later\ngenerations in the case of pedigree, SNP, and haplotype data due to\nrecombinations. On the other hand accuracies were substantially\nhigher with QTL data and quite stable over generations (from 0.75 to\n0.65) though still far from perfect (even though QTL genotypes are\nknown), due to estimation errors. Results demonstrate the value and\nlimitations of genotypic information for the evaluation of additive\ngenetic merit in animal populations."], "link": "http://feedproxy.google.com/~r/GregorGorjancsBlog/~3/Wh2Z7hyJJEE/whole-genome-evaluation-of-complex.html", "bloglinks": {}, "links": {"http://www.uni-mb.si/": 1, "http://www.scribd.com/": 1}, "blogtitle": "Gregor Gorjanc (gg)"}, {"content": ["Here are some cool tools for animal genetics: \n \n \n AGDP for the analysis of genome differences between opulations \n SNPEVG graphical tool for SNP effect viewing and graphing \n ..."], "link": "http://feedproxy.google.com/~r/GregorGorjancsBlog/~3/uvXEEMmJ4Yk/software-tools-for-animal-gene-mapping.html", "bloglinks": {}, "links": {"http://animalgene.umn.edu/": 1}, "blogtitle": "Gregor Gorjanc (gg)"}, {"content": ["I just realized that Google offers me \"Google drive\". The pricing options for larger disk space than 5GB are very competitive with Dropbox! I am using Dropbox for all my files - yes, it costs me quite some money when the bill comes, but if we consider this is \"few\" dollars per month for backup and synchronization I am more than willing to pay this amount for this!!! Google drives is now yet another option, but the desktop folder does not work on Linux so for now I will stick with Dropbox."], "link": "http://feedproxy.google.com/~r/GregorGorjancsBlog/~3/ShE82onNnQ0/google-drive-drives-in.html", "bloglinks": {}, "links": {"https://support.google.com/": 1}, "blogtitle": "Gregor Gorjanc (gg)"}, {"content": ["You can find here some top-notch presentations on animal breeding and genetics/genomics."], "link": "http://feedproxy.google.com/~r/GregorGorjancsBlog/~3/jYjGtrmXCRU/aipl-presentations-on-animal-breeding.html", "bloglinks": {}, "links": {"http://aipl.arsusda.gov/": 1}, "blogtitle": "Gregor Gorjanc (gg)"}, {"content": ["There will be an ESF GENOMIC-RESOURCES ( link1 , link2 ) summer school \u201cLivestock Conservation Genomics: Data, Tools and Trends\u201c Summer School, Croatia, Oct 1-7, 2012. You can find more details here ."], "link": "http://feedproxy.google.com/~r/GregorGorjancsBlog/~3/oU3wjVy901s/livestock-conservation-genomics-data.html", "bloglinks": {}, "links": {"http://www.esf.org/": 1, "http://genomic-resources.epfl.ch/": 1, "http://www.unizg.hr/": 1}, "blogtitle": "Gregor Gorjanc (gg)"}, {"content": ["SNPduo - compare SNPs from two individuals \n SNPtrio - compare SNPs from a family trio - very cool plots and nice diagnostics \n kcoeff - estimate K0, K1, and K2 coefficients from SNP data"], "link": "http://feedproxy.google.com/~r/GregorGorjancsBlog/~3/ZIgUSZIMfMk/nice-snp-tools-from-pevsner-laboratory.html", "bloglinks": {}, "links": {"http://pevsnerlab.kennedykrieger.org/": 3}, "blogtitle": "Gregor Gorjanc (gg)"}, {"content": ["The Quantomics group had a meeting in September 2011 and published was a very nice set of presentations on EU FP7 Livestock Genomics projects."], "link": "http://feedproxy.google.com/~r/GregorGorjancsBlog/~3/7iTtBqf1UEE/eu-fp7-livestock-genomics-projects.html", "bloglinks": {}, "links": {"http://www.quantomics.eu/": 2}, "blogtitle": "Gregor Gorjanc (gg)"}, {"content": ["Follow links bellow to see slides and videos! \n \n ICAR: Partitioning international genetic trends by origin in Holstein bulls \n InterBull: Accuracy of breeding values from pedigree and genome based models in selected populations \n \nOther talks as are available from here ."], "link": "http://feedproxy.google.com/~r/GregorGorjancsBlog/~3/6Dok1l-f3aI/interbull-and-icar-talks-from-cork.html", "bloglinks": {}, "links": {"http://www.icar.org/": 1, "http://www.icar2012.ie/": 2}, "blogtitle": "Gregor Gorjanc (gg)"}, {"content": ["Lots of short videos on how to do several things in R."], "link": "http://feedproxy.google.com/~r/GregorGorjancsBlog/~3/7vuPOU2uzEs/2-min-howto-in-r.html", "bloglinks": {}, "links": {"http://www.twotorials.com/": 1}, "blogtitle": "Gregor Gorjanc (gg)"}, {"content": ["See here ."], "link": "http://feedproxy.google.com/~r/GregorGorjancsBlog/~3/0qHkprpdYRY/animal-breeding-and-genetics-progress.html", "bloglinks": {}, "links": {"http://www.youtube.com/": 1}, "blogtitle": "Gregor Gorjanc (gg)"}, {"content": ["Mathematical Monk channel featuring Information Theory, Machine Learning, and Probability Primer \n Coursera featuring loads of material from Princeton, Stanford, Michigan, and Penn \n Udacity"], "link": "http://feedproxy.google.com/~r/GregorGorjancsBlog/~3/1G92uAhOpN8/some-more-study-video-material.html", "bloglinks": {}, "links": {"https://www.youtube.com/": 1, "https://www.coursera.org/": 1, "http://www.udacity.com/": 1}, "blogtitle": "Gregor Gorjanc (gg)"}, {"content": ["Our (Hickey and Gorjanc) paper describing simulation using coalescent and gene drop methods has been published in the new open G3 journal. This contribution is a part of the Genomic selection collection of the Genetic Society of America that is nicely described here ."], "link": "http://feedproxy.google.com/~r/GregorGorjancsBlog/~3/YCTf8U_64yI/simulated-data-for-genomic-selection.html", "bloglinks": {}, "links": {"http://www.genetics.org/": 2, "http://www.g3journal.org/": 1}, "blogtitle": "Gregor Gorjanc (gg)"}, {"content": ["Here is a cool online application that takes chalkboard with Bart Simpsons and adds your text on it."], "link": "http://feedproxy.google.com/~r/GregorGorjancsBlog/~3/fZ1iT7T6x3w/chalk-letter-generator.html", "bloglinks": {}, "links": {"http://www.addletters.com/": 2}, "blogtitle": "Gregor Gorjanc (gg)"}, {"content": ["Pedigree based mixed models (often called animal models, due to modelling animal performance) are the cornerstone of animal breeding and quantitative genetics. There are many programs that can be used for analyzing your data with these models, e.g., ASREML , BLUPf90 , MATVEC , MiXBLUP & MiX99 , SurvivalKit , PEST/VCE, WOMBAT , ...). There are also R packages you can use: pedigreemm and MCMCglmm . If you want to run your own program you can take the example code bellow and start from it. The code shows the essence of building the system of equations that needs to be solved on a simple example. Note that this is mean only for demonstration purposes and small scale analyses. In addition, variance components are assumed known here. In order to understand the model for this simple example a bit better the graphical model view is shown first. \n Graphical model view of simple pedigree based mixed model example \n \n The code: \n \n \n \n \n \n \n options ( width= 200 ) \n \n ### --- Required packages --- \n \n ## install.packages(pkg=c(\"pedigreemm\", \"MatrixModels\")) \n \n library ( package= \"pedigreemm\" )  ## pedigree functions \n library ( package= \"MatrixModels\" ) ## sparse matrices \n \n ### --- Data --- \n \n ## NOTE: \n ## - some individuals have one or both parents (un)known \n ## - some individuals have phenotype (un)known \n ## - some indididuals have repeated phenotype observations \n example <- data.frame ( \n individual= c ( 1 ,  2 ,  2 ,  3 ,  4 ,  5 ,  6 ,  7 ,  8 ,  9 , 10 ) , \n  father= c ( NA , NA , NA ,  2 ,  2 ,  4 ,  2 ,  5 ,  5 , NA ,  8 ) , \n  mother= c ( NA , NA , NA ,  1 , NA ,  3 ,  3 ,  6 ,  6 , NA ,  9 ) , \n phenotype= c ( NA , 103 , 106 , 98 , 101 , 106 , 93 , NA , NA , NA , 109 ) , \n   group = c ( NA ,  1 ,  1 ,  1 ,  2 ,  2 ,  2 , NA , NA , NA ,  1 ) ) \n \n ## Variance components \nsigma2e <- 1 \nsigma2a <- 3 \n ( h2 <- sigma2a / ( sigma2a + sigma2e ) ) \n \n ### --- Setup data --- \n \n ## Make sure each individual has only one record in pedigree \nped <- example [ ! duplicated ( example $individual ) , 1 : 3 ] \n \n ## Factors (this eases buliding the design matrix considerably) \n example $individual <- factor ( example $individual ) \n example $group  <- factor ( example $group ) \n \n ## Phenotype data \ndat <- example [ ! is.na ( example $phenotype ) , ] \n \n ### --- Setup MME --- \n \n ## Phenotype vector \n ( y <- dat$phenotype ) \n \n ## Design matrix for the \"fixed\" effects (group) \n ( X <- model.Matrix ( ~ group ,    data =dat , sparse= TRUE ) ) \n \n ## Design matrix for the \"random\" effects (individual) \n ( Z <- model.Matrix ( ~ individual - 1 , data =dat , sparse= TRUE ) ) \n \n ## Inverse additive relationship matrix \nped2 <- pedigree ( sire=ped$father , dam=ped$mother , label=ped$individual ) \nTInv <- as ( ped2 , \"sparseMatrix\" ) \nDInv <- Diagonal ( x= 1 /Dmat ( ped2 ) ) \nAInv <- crossprod ( sqrt ( DInv ) %*% TInv ) \n \n ## Variance ratio \nalpha <- sigma2e / sigma2a\n \n ## Mixed Model Equations (MME) \n \n ## ... Left-Hand Side (LHS) without pedigree prior \n ( LHS0 <- rBind ( cBind ( crossprod ( X ) ,  crossprod ( X , Z ) ) , \n    cBind ( crossprod ( Z , X ) , crossprod ( Z , Z ) ) ) ) \n \n ## ... Left-Hand Side (LHS) with pedigree prior \n round ( \n LHS <- rBind ( cBind ( crossprod ( X ) ,  crossprod ( X , Z ) ) , \n    cBind ( crossprod ( Z , X ) , crossprod ( Z , Z ) + AInv * alpha ) ) , digits= 1 ) \n \n ## ... Right-Hand Side (RHS) \n ( RHS <- rBind ( crossprod ( X , y ) , \n    crossprod ( Z , y ) ) ) \n \n ### --- Solutions --- \n \n ## Solve \nLHSInv <- solve ( LHS ) \nsol <- LHSInv %*% RHS\n \n ## Standard errors \nse <- diag ( LHSInv ) * sigma2e\n \n ## Reliabilities \nr2 <- 1 - diag ( LHSInv ) * alpha\n \n ## Accuracies \nr <- sqrt ( r2 ) \n \n ## Printout \ncBind ( sol , se , r , r2 ) \n \n \n Created by Pretty R at inside-R.org \n \n \n And the transcript: \n \n \n \n R version 2.14.2 ( 2012 -02- 29 ) \nCopyright ( C ) 2012 The R Foundation for Statistical Computing\nISBN 3 - 900051 -07- 0 \n Platform : x86_64-pc-linux-gnu ( 64 - bit ) \n \nR is free software and comes with ABSOLUTELY NO WARRANTY.\nYou are welcome to redistribute it under certain conditions.\nType 'license()' or 'licence()' for distribution details.\n \n Natural language support but running in an English locale\n \nR is a collaborative project with many contributors.\nType 'contributors()' for more information and\n 'citation()' on how to cite R or R packages in publications.\n \nType 'demo()' for some demos , 'help()' for on- line  help , or\n 'help.start()' for an HTML browser interface to help.\nType 'q()' to quit R.\n \n [ Previously saved workspace restored ] \n \n> \n> options ( width= 200 ) \n> \n> ### --- Required packages --- \n> \n> ## install.packages(pkg=c(\"pedigreemm\", \"MatrixModels\")) \n> \n> library ( package= \"pedigreemm\" )  ## pedigree functions \nLoading required package: lme4 \nLoading required package: Matrix \nLoading required package: lattice \n \nAttaching package: \u2018 Matrix \u2019\n \nThe following object ( s ) are masked from \u2018package: base \u2019:\n \n  det \n \n \nAttaching package: \u2018 lme4 \u2019\n \nThe following object ( s ) are masked from \u2018package: stats \u2019:\n \n  AIC , BIC \n \n> library ( package= \"MatrixModels\" ) ## sparse matrices \n> \n> ### --- Data --- \n> \n> ## NOTE: \n> ## - some individuals have one or both parents (un)known \n> ## - some individuals have phenotype (un)known \n> ## - some indididuals have repeated phenotype observations \n> example <- data.frame ( \n+ individual= c ( 1 ,  2 ,  2 ,  3 ,  4 ,  5 ,  6 ,  7 ,  8 ,  9 , 10 ) , \n+  father= c ( NA , NA , NA ,  2 ,  2 ,  4 ,  2 ,  5 ,  5 , NA ,  8 ) , \n+  mother= c ( NA , NA , NA ,  1 , NA ,  3 ,  3 ,  6 ,  6 , NA ,  9 ) , \n+ phenotype= c ( NA , 103 , 106 , 98 , 101 , 106 , 93 , NA , NA , NA , 109 ) , \n+   group = c ( NA ,  1 ,  1 ,  1 ,  2 ,  2 ,  2 , NA , NA , NA ,  1 ) ) \n> \n> ## Variance components \n> sigma2e <- 1 \n> sigma2a <- 3 \n> ( h2 <- sigma2a / ( sigma2a + sigma2e ) ) \n [ 1 ] 0.75 \n> \n> ### --- Setup data --- \n> \n> ## Make sure each individual has only one record in pedigree \n> ped <- example [ ! duplicated ( example $individual ) , 1 : 3 ] \n> \n> ## Factors (this eases buliding the design matrix considerably) \n> example $individual <- factor ( example $individual ) \n> example $group  <- factor ( example $group ) \n> \n> ## Phenotype data \n> dat <- example [ ! is.na ( example $phenotype ) , ] \n> \n> ### --- Setup MME --- \n> \n> ## Phenotype vector \n> ( y <- dat$phenotype ) \n [ 1 ] 103 106 98 101 106 93 109 \n> \n> ## Design matrix for the \"fixed\" effects (group) \n> ( X <- model.Matrix ( ~ group ,    data =dat , sparse= TRUE ) ) \n \"dsparseModelMatrix\" : 7 x 2 sparse Matrix of class \"dgCMatrix\" \n ( Intercept ) group2\n 2    1  .\n 3    1  .\n 4    1  .\n 5    1  1 \n 6    1  1 \n 7    1  1 \n 11    1  .\n@ assign : 0 1 \n@ contrasts :\n$group\n [ 1 ] \"contr.treatment\" \n \n> \n> ## Design matrix for the \"random\" effects (individual) \n> ( Z <- model.Matrix ( ~ individual - 1 , data =dat , sparse= TRUE ) ) \n \"dsparseModelMatrix\" : 7 x 10 sparse Matrix of class \"dgCMatrix\" \n [ [ suppressing 10 column names \u2018individual1\u2019 , \u2018individual2\u2019 , \u2018individual3\u2019 ... ] ] \n \n 2 . 1 . . . . . . . .\n 3 . 1 . . . . . . . .\n 4 . . 1 . . . . . . .\n 5 . . . 1 . . . . . .\n 6 . . . . 1 . . . . .\n 7 . . . . . 1 . . . .\n 11 . . . . . . . . . 1 \n@ assign : 1 1 1 1 1 1 1 1 1 1 \n@ contrasts :\n$individual\n [ 1 ] \"contr.treatment\" \n \n> \n> ## Inverse additive relationship matrix \n> ped2 <- pedigree ( sire=ped$father , dam=ped$mother , label=ped$individual ) \n> TInv <- as ( ped2 , \"sparseMatrix\" ) \n> DInv <- Diagonal ( x= 1 /Dmat ( ped2 ) ) \n> AInv <- crossprod ( sqrt ( DInv ) %*% TInv ) \n> \n> ## Variance ratio \n> alpha <- sigma2e / sigma2a\n> \n> ## Mixed Model Equations (MME) \n> \n> ## ... Left-Hand Side (LHS) without pedigree prior \n> ( LHS0 <- rBind ( cBind ( crossprod ( X ) ,  crossprod ( X , Z ) ) , \n+    cBind ( crossprod ( Z , X ) , crossprod ( Z , Z ) ) ) ) \n 12 x 12 sparse Matrix of class \"dgCMatrix\" \n [ [ suppressing 12 column names \u2018 ( Intercept ) \u2019 , \u2018group2\u2019 , \u2018individual1\u2019 ... ] ] \n \n ( Intercept ) 7 3 . 2 1 1 1 1 . . . 1 \ngroup2  3 3 . . . 1 1 1 . . . .\nindividual1 . . . . . . . . . . . .\nindividual2 2 . . 2 . . . . . . . .\nindividual3 1 . . . 1 . . . . . . .\nindividual4 1 1 . . . 1 . . . . . .\nindividual5 1 1 . . . . 1 . . . . .\nindividual6 1 1 . . . . . 1 . . . .\nindividual7 . . . . . . . . . . . .\nindividual8 . . . . . . . . . . . .\nindividual9 . . . . . . . . . . . .\nindividual10 1 . . . . . . . . . . 1 \n> \n> ## ... Left-Hand Side (LHS) with pedigree prior \n> round ( \n+ LHS <- rBind ( cBind ( crossprod ( X ) ,  crossprod ( X , Z ) ) , \n+    cBind ( crossprod ( Z , X ) , crossprod ( Z , Z ) + AInv * alpha ) ) , digits= 1 ) \n 12 x 12 sparse Matrix of class \"dgCMatrix\" \n [ [ suppressing 12 column names \u2018 ( Intercept ) \u2019 , \u2018group2\u2019 , \u2018individual1\u2019 ... ] ] \n \n ( Intercept ) 7 3 .  2.0 1.0 1.0 1.0 1.0 . . .  1.0 \ngroup2  3 3 . . .  1.0 1.0 1.0 . . . . \nindividual1 . . 0.5 0.2 - 0.3 . . . . . . . \nindividual2 2 . 0.2 2.8 - 0.2 - 0.2 . - 0.3 . . . . \nindividual3 1 . - 0.3 - 0.2 2.0 0.2 - 0.3 - 0.3 . . . . \nindividual4 1 1 . - 0.2 0.2 1.6 - 0.3 . . . . . \nindividual5 1 1 . . - 0.3 - 0.3 2.1 0.4 - 0.4 - 0.4 . . \nindividual6 1 1 . - 0.3 - 0.3 .  0.4 2.1 - 0.4 - 0.4 . . \nindividual7 . . . . . . - 0.4 - 0.4 0.8 . . . \nindividual8 . . . . . . - 0.4 - 0.4 .  1.0 0.2 - 0.4 \nindividual9 . . . . . . . . .  0.2 0.5 - 0.4 \nindividual10 1 . . . . . . . . - 0.4 - 0.4 1.8 \n> \n> ## ... Right-Hand Side (RHS) \n> ( RHS <- rBind ( crossprod ( X , y ) , \n+     crossprod ( Z , y ) ) ) \n 12 x 1 Matrix of class \"dgeMatrix\" \n    [ , 1 ] \n ( Intercept )  716 \ngroup2   300 \nindividual1  0 \nindividual2 209 \nindividual3  98 \nindividual4 101 \nindividual5 106 \nindividual6  93 \nindividual7  0 \nindividual8  0 \nindividual9  0 \nindividual10 109 \n> \n> ### --- Solutions --- \n> \n> ## Solve \n> LHSInv <- solve ( LHS ) \n> sol <- LHSInv %*% RHS\n> \n> ## Standard errors \n> se <- diag ( LHSInv ) * sigma2e\n> \n> ## Reliabilities \n> r2 <- 1 - diag ( LHSInv ) * alpha\n> \n> ## Accuracies \n> r <- sqrt ( r2 ) \nWarning message :\nIn sqrt ( r2 ) : NaNs produced\n> \n> ## Printout \n> cBind ( sol , se , r , r2 ) \n 12 x 4 Matrix of class \"dgeMatrix\" \n       se   r   r2\n [ 1 , ] 104.76444809 1.901479 0.6051228 0.3661736 \n [ 2 , ] - 4.65061921 1.376348 0.7356748 0.5412175 \n [ 3 , ] - 2.62685846 2.432448 0.4349528 0.1891839 \n [ 4 , ] - 0.77797260 1.983301 0.5821509 0.3388997 \n [ 5 , ] - 4.32927399 1.979138 0.5833415 0.3402874 \n [ 6 , ]  1.54997883 2.316720 0.4772421 0.2277600 \n [ 7 , ]  3.18706240 2.604540 0.3630701 0.1318199 \n [ 8 , ] - 5.07852788 2.508673 0.4046922 0.1637758 \n [ 9 , ] - 0.94573274 3.459904   NaN - 0.1533013 \n [ 10 , ] - 0.08765651 3.534636   NaN - 0.1782121 \n [ 11 , ]  2.11218764 2.511203 0.4036487 0.1629323 \n [ 12 , ]  2.82742681 2.009539 0.5745901 0.3301538 \n> \n> proc.time ( ) \n user system elapsed \n 3.350  0.070  3.425 \n \n \n Created by Pretty R at inside-R.org"], "link": "http://feedproxy.google.com/~r/GregorGorjancsBlog/~3/oulGeCRX4rA/small-pedigree-based-mixed-model.html", "bloglinks": {}, "links": {"http://www.mixblup.eu/": 1, "http://www.inside-r.org/": 2, "http://cran.r-project.org/": 2, "https://portal.mtt.fi/": 1, "http://www.scribd.com/": 1, "http://nce.uga.edu/": 1, "http://inside-r.org/": 143, "http://www.co.uk/": 1, "http://www4.inra.fr/": 1, "http://didgeridoo.edu.au/": 1, "http://statistics.unl.edu/": 1}, "blogtitle": "Gregor Gorjanc (gg)"}, {"content": ["Nice \" explanation \" by W. Li."], "link": "http://feedproxy.google.com/~r/GregorGorjancsBlog/~3/aiU1o7SfvQY/linkage-versus-linkage-disequilibrium.html", "bloglinks": {}, "links": {"http://linkage.rockefeller.edu/": 1}, "blogtitle": "Gregor Gorjanc (gg)"}, {"content": ["Linear regression is one of the key concepts in statistics [ wikipedia1 , wikipedia2 ]. However, people are often confuse the meaning of parameters of linear regression - the intercept tells us the average value of y at x=0, while the slope tells us how much change of y can we expect on average when we change x for one unit - exactly the same as in the linear function , though we use averages here due to noise. \n \n \n \nToday colleague got confused with the meaning of adjusting covariate (x variable) and the effect of parameter estimates. By shifting the x scale, we also shift the point at which intercept is estimated. I made the following graph to demonstrate this point in the case of nested regression of y on x within a group factor having two levels. R code to produce this plots is shown on bottom. \n Regression - covariate adjustment \n \n \n \n library ( package= \"MASS\" ) \n \nx1 <- mvrnorm ( n= 100 , mu= 50 , Sigma= 20 , empirical= TRUE ) \nx2 <- mvrnorm ( n= 100 , mu= 70 , Sigma= 20 , empirical= TRUE ) \n \nmu1 <- mu2 <- 4 \nb1 <- 0.300 \nb2 <- 0.250 \n \ny1 <- mu1 + b1 * x1 + rnorm ( n= 100 , sd = 1 ) \ny2 <- mu2 + b2 * x2 + rnorm ( n= 100 , sd = 1 ) \n \nx <- c ( x1 , x2 ) \nxK <- x - 60 \ny <- c ( y1 , y2 ) \ng <- factor ( rep ( c ( 1 , 2 ) , each= 100 ) ) \n \n par ( mfrow= c ( 2 , 1 ) , pty= \"m\" , bty= \"l\" ) \n \n ( fit1n <- lm ( y ~ g + x + x:g ) ) \n ## (Intercept)   g2   x   g2:x \n ##  3.06785  2.32448  0.31967  -0.09077 \n beta <- coef ( fit1n ) \n \n plot ( y ~ x , col = c ( \"blue\" , \"red\" ) [ g ] , ylim= c ( 0 , max ( y ) ) , xlim= c ( 0 , max ( x ) ) , pch= 19 , cex= 0.25 ) \n points ( x= mean ( x1 ) , y= mean ( y1 ) , pch= 19 ) \n points ( x= mean ( x2 ) , y= mean ( y2 ) , pch= 19 ) \n abline ( v= c ( mean ( x1 ) , mean ( x2 ) ) , lty= 2 , col = \"gray\" ) \n abline ( h= c ( mean ( y1 ) , mean ( y2 ) ) , lty= 2 , col = \"gray\" ) \n \n points ( x= 0 , y= beta [ \"(Intercept)\" ] ,    pch= 19 , col = \"blue\" ) \n points ( x= 0 , y= beta [ \"(Intercept)\" ] + beta [ \"g2\" ] , pch= 19 , col = \"red\" ) \n \nz <- 0 : max ( x ) \n lines ( y= beta [ \"(Intercept)\" ]    + beta [ \"x\" ] * z     , x=z , col = \"blue\" ) \n lines ( y= ( beta [ \"(Intercept)\" ] + beta [ \"g2\" ] ) + ( beta [ \"x\" ] + beta [ \"g2:x\" ] ) * z , x=z , col = \"red\" ) \n \n ( fit2n <- lm ( y ~ g + xK + xK:g ) ) \n ## (Intercept)   g2   xK  g2:xK \n ## 22.24824  -3.12153  0.31967  -0.09077 \n beta <- coef ( fit2n ) \n \n plot ( y ~ x , col = c ( \"blue\" , \"red\" ) [ g ] , ylim= c ( 0 , max ( y ) ) , xlim= c ( 0 , max ( x ) ) , pch= 19 , cex= 0.25 ) \n points ( x= mean ( x1 ) , y= mean ( y1 ) , pch= 19 ) \n points ( x= mean ( x2 ) , y= mean ( y2 ) , pch= 19 ) \n abline ( v= c ( mean ( x1 ) , mean ( x2 ) ) , lty= 2 , col = \"gray\" ) \n abline ( h= c ( mean ( y1 ) , mean ( y2 ) ) , lty= 2 , col = \"gray\" ) \n \n abline ( v= 60 , lty= 2 , col = \"gray\" ) \n \n points ( x= 60 , y= beta [ \"(Intercept)\" ] ,    pch= 19 , col = \"blue\" ) \n points ( x= 60 , y= beta [ \"(Intercept)\" ] + beta [ \"g2\" ] , pch= 19 , col = \"red\" ) \n \nz <- 0 : max ( x ) - 60 \n lines ( y= beta [ \"(Intercept)\" ]    + beta [ \"xK\" ] * z     , x=z + 60 , col = \"blue\" ) \n lines ( y= ( beta [ \"(Intercept)\" ] + beta [ \"g2\" ] ) + ( beta [ \"xK\" ] + beta [ \"g2:xK\" ] ) * z , x=z + 60 , col = \"red\" ) \n \n \n Created by Pretty R at inside-R.org"], "link": "http://feedproxy.google.com/~r/GregorGorjancsBlog/~3/hjhzt71A6Gg/regression-covariate-adjustment.html", "bloglinks": {}, "links": {"http://inside-r.org/": 104, "http://www.scribd.com/": 1, "http://en.wikipedia.org/": 3, "http://www.inside-r.org/": 1}, "blogtitle": "Gregor Gorjanc (gg)"}, {"content": ["Shirin Amiri was asking about GBLUP (genomic BLUP) and based on her example I set up the following R script to show how GBLUP works. Note that this is the so called marker model, where we estimate allele substitution effects of the markers and not individual based model, where genomic breeding values are inferred directly. The code: \n \n \n \n library ( package= \"MatrixModels\" ) \n \ndat <- data.frame ( y= c ( 1.5 , 2.35 , 3.4 , 2.31 , 1.53 ) , \n     s1= c ( \"AA\" , \"Aa\" , \"Aa\" , \"AA\" , \"aa\" ) , \n     s2= c ( \"Bb\" , \"BB\" , \"bb\" , \"BB\" , \"bb\" ) , \n     s3= c ( \"cc\" , \"Cc\" , \"Cc\" , \"cc\" , \"CC\" ) , \n     s4= c ( \"Dd\" , \"Dd\" , \"DD\" , \"dd\" , \"Dd\" ) ) \n \ncols <- paste ( \"s\" , 1 : 4 , sep= \"\" ) \ndat [ , cols ] <- lapply ( dat [ , cols ] , function ( z ) as.integer ( z ) - 1 ) \n \nlambda <- 1 \n \n ( y <- dat$y ) \n ( X <- model.Matrix ( y ~ 1 ,      data =dat , sparse= TRUE ) ) \n ( Z <- model.Matrix ( y ~ - 1 + s1 + s2 + s3 + s4 , data =dat , sparse= TRUE ) ) \n \nXX <- crossprod ( X ) \nXZ <- crossprod ( X , Z ) \nZZ <- crossprod ( Z ) \n \nXy <- crossprod ( X , y ) \nZy <- crossprod ( Z , y ) \n \n ( LHS <- rBind ( cBind ( XX ,  XZ ) , \n    cBind ( t ( XZ ) , ZZ + Diagonal ( n= dim ( ZZ ) [ 1 ] ) * lambda ) ) ) \n \n ( RHS <- rBind ( Xy , \n    Zy ) ) \n \n ( sol <- solve ( LHS , RHS ) ) \n \n ( GEBV <- Z %*% sol [ - 1 ] ) \n \n \n \nAnd the transcript: \n \n \n \n R version 2.14.2 ( 2012 -02- 29 ) \nCopyright ( C ) 2012 The R Foundation for Statistical Computing\nISBN 3 - 900051 -07- 0 \n Platform : x86_64-pc-linux-gnu ( 64 - bit ) \n \nR is free software and comes with ABSOLUTELY NO WARRANTY.\nYou are welcome to redistribute it under certain conditions.\nType 'license()' or 'licence()' for distribution details.\n \n Natural language support but running in an English locale\n \nR is a collaborative project with many contributors.\nType 'contributors()' for more information and\n 'citation()' on how to cite R or R packages in publications.\n \nType 'demo()' for some demos , 'help()' for on- line  help , or\n 'help.start()' for an HTML browser interface to help.\nType 'q()' to quit R.\n \n> \n> library ( package= \"MatrixModels\" ) \nLoading required package: Matrix \nLoading required package: lattice \n \nAttaching package: \u2018 Matrix \u2019\n \nThe following object ( s ) are masked from \u2018package: base \u2019:\n \n  det \n \n \nAttaching package: \u2018MatrixModels\u2019\n \nThe following object ( s ) are masked from \u2018package: stats \u2019:\n \n getCall\n \n> \n> dat <- data.frame ( y= c ( 1.5 , 2.35 , 3.4 , 2.31 , 1.53 ) , \n+     s1= c ( \"AA\" , \"Aa\" , \"Aa\" , \"AA\" , \"aa\" ) , \n+     s2= c ( \"Bb\" , \"BB\" , \"bb\" , \"BB\" , \"bb\" ) , \n+     s3= c ( \"cc\" , \"Cc\" , \"Cc\" , \"cc\" , \"CC\" ) , \n+     s4= c ( \"Dd\" , \"Dd\" , \"DD\" , \"dd\" , \"Dd\" ) ) \n> \n> cols <- paste ( \"s\" , 1 : 4 , sep= \"\" ) \n> dat [ , cols ] <- lapply ( dat [ , cols ] , function ( z ) as.integer ( z ) - 1 ) \n> \n> lambda <- 1 \n> \n> ( y <- dat$y ) \n [ 1 ] 1.50 2.35 3.40 2.31 1.53 \n> ( X <- model.Matrix ( y ~ 1 ,      data =dat , sparse= TRUE ) ) \n \"dsparseModelMatrix\" : 5 x 1 sparse Matrix of class \"dgCMatrix\" \n ( Intercept ) \n 1    1 \n 2    1 \n 3    1 \n 4    1 \n 5    1 \n@ assign : 0 \n@ contrasts :\nnamed list ( ) \n> ( Z <- model.Matrix ( y ~ - 1 + s1 + s2 + s3 + s4 , data =dat , sparse= TRUE ) ) \n \"dsparseModelMatrix\" : 5 x 4 sparse Matrix of class \"dgCMatrix\" \n s1 s2 s3 s4\n 1 2 1 . 1 \n 2 1 2 1 1 \n 3 1 . 1 2 \n 4 2 2 . .\n 5 . . 2 1 \n@ assign : 1 2 3 4 \n@ contrasts :\nnamed list ( ) \n> \n> XX <- crossprod ( X ) \n> XZ <- crossprod ( X , Z ) \n> ZZ <- crossprod ( Z ) \n> \n> Xy <- crossprod ( X , y ) \n> Zy <- crossprod ( Z , y ) \n> \n> ( LHS <- rBind ( cBind ( XX ,  XZ ) , \n+    cBind ( t ( XZ ) , ZZ + Diagonal ( n= dim ( ZZ ) [ 1 ] ) * lambda ) ) ) \n 5 x 5 sparse Matrix of class \"dgCMatrix\" \n    ( Intercept ) s1 s2 s3 s4\n ( Intercept )    5 6 5 4 5 \ns1      6 11 8 2 5 \ns2      5 8 10 2 3 \ns3      4 2 2 7 5 \ns4      5 5 3 5 8 \n> \n> ( RHS <- rBind ( Xy , \n+    Zy ) ) \n 5 x 1 Matrix of class \"dgeMatrix\" \n    [ , 1 ] \n ( Intercept ) 11.09 \ns1   13.37 \ns2   10.82 \ns3   8.81 \ns4   12.18 \n> \n> ( sol <- solve ( LHS , RHS ) ) \n 5 x 1 Matrix of class \"dgeMatrix\" \n     [ , 1 ] \n ( Intercept ) 1.65468864 \ns1   0.05223443 \ns2   0.08655678 \ns3   - 0.05223443 \ns4   0.45586081 \n> \n> ( GEBV <- Z %*% sol [ - 1 ] ) \n 5 x 1 Matrix of class \"dgeMatrix\" \n  [ , 1 ] \n 1 0.6468864 \n 2 0.6289744 \n 3 0.9117216 \n 4 0.2775824 \n 5 0.3513919 \n> \n> proc.time ( ) \n user system elapsed \n 2.330  0.070  2.412"], "link": "http://feedproxy.google.com/~r/GregorGorjancsBlog/~3/pxQQvfGNlzE/gblup-example-in-r.html", "bloglinks": {}, "links": {"http://inside-r.org/": 88}, "blogtitle": "Gregor Gorjanc (gg)"}, {"content": ["Genomska selekcija rjave pasme goveda v Sloveniji \n\n \n \n Use of AlphaDrop in the simulation approach to genomic selection and mate allocation \n\n Genomska selekcija"], "link": "http://feedproxy.google.com/~r/GregorGorjancsBlog/~3/1l_M5VFL6GI/recent-talks.html", "bloglinks": {}, "links": {"http://www.scribd.com/": 4}, "blogtitle": "Gregor Gorjanc (gg)"}, {"content": ["See nice description here . In short using the command bellow on my Linux box (Windows users see PDFCreator ) allowed me to reduce scanned color PDF for a factor of 4 to 5, e.g., from ~14 MB to ~3 MB. Supposedly PDFCreator also \n \n \n \n gs -sDEVICE=pdfwrite -dMaxSubsetPct=100 -dPDFSETTINGS=/ebook -sOutputFile=\"out.pdf\" -dNOPAUSE -dBATCH \"in.pdf\" \n \n Update (2012-01-16): you can get a nice shell script called compressPDF.sh that saves some typing and can process multiple files, e.g., \n \n compressPDF.sh file.pdf"], "link": "http://feedproxy.google.com/~r/GregorGorjancsBlog/~3/P_SP3RD8WS0/compress-pdf.html", "bloglinks": {}, "links": {"http://sourceforge.net/": 1, "http://www.peteryu.ca/": 1, "https://sites.google.com/": 1}, "blogtitle": "Gregor Gorjanc (gg)"}, {"content": ["Interested in genetics - in looking genotype data on pedigrees? Check out VIPER (Visual Interactive Pedigree ExploreR). Looks really cool!!!"], "link": "http://feedproxy.google.com/~r/GregorGorjancsBlog/~3/zhMBqHapIrs/viper-cool-pedigree-data-view.html", "bloglinks": {}, "links": {"http://www.org.uk/": 1}, "blogtitle": "Gregor Gorjanc (gg)"}, {"content": ["Prosojnice z dana\u0161nje predstavitve o ocenjevanju parametrov v Bayesovski statistiki na IBMI so na voljo tukaj . \n Ocenjevanje parametrov v Bayesovski statistiki"], "link": "http://feedproxy.google.com/~r/GregorGorjancsBlog/~3/1JQk0Hmu3Vg/ocenjevanje-parametrov-v-bayesovski.html", "bloglinks": {}, "links": {"http://www.scribd.com/": 2, "http://ibmi.uni-lj.si/": 1}, "blogtitle": "Gregor Gorjanc (gg)"}, {"content": ["Khan Academy - a set of 2600 free videos from basic to more advances quantitative skills \n Introduction to Artifical Inteligence - Stanford on-line course for masses \n Machine Learning - Stanford on-line course for masses"], "link": "http://feedproxy.google.com/~r/GregorGorjancsBlog/~3/b7ivHQO2OnY/recently-discovered-study-resources.html", "bloglinks": {}, "links": {"http://www.ml-class.org/": 1, "http://www.khanacademy.org/": 1, "http://www.ai-class.com/": 1}, "blogtitle": "Gregor Gorjanc (gg)"}, {"content": ["Ov\u010dereja na Norve\u0161kem"], "link": "http://feedproxy.google.com/~r/GregorGorjancsBlog/~3/EKDSL1hEf48/ovcereja-na-norveskem.html", "bloglinks": {}, "links": {"http://www.scribd.com/": 1}, "blogtitle": "Gregor Gorjanc (gg)"}]