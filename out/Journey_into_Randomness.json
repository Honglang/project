[{"blogurl": "http://linbaba.wordpress.com\n", "blogroll": [], "title": "Journey into Randomness"}, {"content": ["Sequential Monte Carlo (SMC) methods are usually designed to deal with probability distributions of increasing dimensions. The canonical example is the sequence of distributions where is a hidden Markov chain and is an observation process. The notation is a shortcut for . This is usually called a Hidden Markov Model in the literature. If the Markov chain evolves on in then the distribution is a probability on . \n  \n It turns out that one can use the same kind of ideas to study a single distribution . If is difficult to sample directly from and that it is difficult to use traditional MCMC methods (because of the dimensionality, multi-modality, poor mixing properties, etc\u2026), one can try to use SMC methods to study the distribution . To this end, one can introduce a sequence of bridging distributions \n \n where is typically very easy to sample from and . A traditional choice is where . The bigger the index , the more intricate the distribution is. The problem is that each distribution has the same dimensionality as the original distribution so that it is difficult to use all the machinery of SMC methods. For the sake of concreteness, let us suppose that is a distribution on . A fundamental remark that is the base of what is now known as Sequential Monte Carlo samplers is that can be seen as the marginal distribution of the probability \n \n where are Markov kernels in the sense that for any we have . The distribution lives on and one can use the traditional SMC methods to explore the sequence of distributions . This algorithm was devised a few years ago by Pierre Del Moral , Arnaud Doucet and Ajay Jasra . It is extremely powerful and several other algorithms can be seen as particular cases of it. Because I had never implemented the algorithm before, I tried yesterday to see how this worked on a very simple example. My target distribution was an equal mixture of seven Gaussian distributions in with unit covariance matrices and centred at the vertices of a regular heptagon with radius . I started with particles at the centre of the heptagon and let them evolved according to a random walk. When the Effective Sampling Size (ESS) was too small (less than ), the whole particle system was regenerated. In order to obtain a sweet movie, I used bridge distributions . \n  \n The result is clear and quite impressive. Indeed, this could have been made much more efficient by taking much less bridge distributions. Some recent theory has been developed to analyse the stability of the algorithm in high dimensional situations. The analysis described in the article uses a scaling limit approach very similar to some ideas used to analyse MCMC algorithms and some more recent developements along the same lines that we have done with Andrew and Natesh . Very exciting stuff! \n \n [EDIT: 2 October 2012] \n I received several emails asking me to describe how to obtain the short animation showing the evolution of the particles system. The code is available here. This is a quick python script producing a bunch of .png files. It then suffices to stick them together to obtain an animated .gif file. This can for example easily be done using the free (and very good) photoshop-like software GIMP . Open all the png files as different layers. Export the result as a .gif file with the option \u2018animated gif\u2019 checked. Voila!"], "link": "http://linbaba.wordpress.com/2012/09/29/smc_sampler/", "bloglinks": {}, "links": {"http://feeds.wordpress.com/": 1, "http://www2.ac.uk/": 1, "http://arxiv.org/": 2, "http://www.u-bordeaux1.fr/": 1, "http://linbaba.wordpress.com/": 5, "http://en.wikipedia.org/": 1, "http://www.gimp.org/": 1, "http://goo.gl/": 3, "http://codeviewer.org/": 1, "http://www.ubc.ca/": 1}, "blogtitle": "Journey into Randomness"}, {"content": ["Start flipping a coin. How long should you wait (on average) before observing the pattern !? Easy you might say, that\u2019s simply the hitting time of the state starting from state of the following Markov chain. \n \nIndeed, one can solve this kind of problem using a first step analysis. In other words, if is the expected number of steps before reaching starting from , is the expected number of steps before reaching starting from , is the expected number of steps before reaching starting from , etc\u2026 one can readily see that verify the system of equations \n \n After a finite amount of time and coffee one then come up with the answer . That was a little bit tedious and I don\u2019t really want to know how long one should wait on average before observing the sequence . \n It turns out that there is a very neat way to approach this kind of problems without solving any linear system. Apparently, this trick was discovered in the 80s by Shuo-Yen Robert Li . As often in probability, this boils down to introducing a clever martingale. Suppose that one wants to know how long it takes on average before observing the magic coin pattern of length with for all . To this end, one will introduce an army of gamblers, a casino, a game of chance and a martingale. The martingale describes the amount of money earned by the casino. At each round (starting at round ) the casino tosses a coin and the gamblers can make bets. If a gambler starts betting just before round , he wins if the coin shows . If he decides to bet again at round , he wins if the coin shows , etc\u2026 Suppose that there are infinitely many gamblers and that gambler starts betting just before round . The game is fair in the sense that if a gambler bets an amount , with probability he gets and with probability he losses his bet. One supposes that gambler starts betting dollar just before round and keeps reinvesting his total capital until he either losses everything (total loss equals dollar) or observes the magic coin pattern (total earning equals ). Indeed, the amount of money earned by the casino is a martingale and . For example, if the first gambler loses his bet and if the wins. Consider the time when the magic coin pattern first appears. This is a stopping time and the optional stopping theorem for martingales shows that . Indeed, one can also compute this quantity another way. By time , all the losers have given dollar to the casino. Also, if the gambler is still in the game he has won a total amount . in other words, \n \n where if the gambler is still in the game after the round and otherwise. The fundamental remark is that the quantity is not random so that . Indeed, right after round one can know with certainty whether is still in the game or not. Gambler is in the game only if the last letters of the magic word are the same as the first letters. For example, if the magic word is then the gamblers who have seen the pattern , and at time are still in the game when the magic word first appear. In this case this shows that . \n \n For example, this immediately shows that we have to wait on average coin tosses before observing the pattern ."], "link": "http://linbaba.wordpress.com/2012/09/22/gamblers/", "bloglinks": {}, "links": {"http://goo.gl/": 1, "http://linbaba.wordpress.com/": 1, "http://feeds.wordpress.com/": 1, "http://www.edu.hk/": 1}, "blogtitle": "Journey into Randomness"}, {"content": ["Here is a delightful probabilistic proof that extracted from a recent article by Greg Markowsky . This starts with pretty lemma (which can originally be found in this article ) on the exit time of a dimensional Brownian motion . Suppose that is an analytic function on the neighbourhood of the unit disk. This function maps the unit disk to with boundary where . A two dimensional brownian motion started at takes on average \n \n to exit the domain where and is the hitting time of the boundary . Indeed, since the situation is invariant by translation one can always suppose that . The proof of this result is a simple martingale argument. Indeed, since is a martingale, the optional stopping theorem shows that \n \n Then, since is an analytic function, Ito\u2019s formula shows that the trajectories of are the same as the trajectories of , up to a time change, where is another dimensional Brownian motion started at . Consequently, where is the hitting time . This shows that \n \n Since Parseval \u2018s theorem (or a direct calculation) shows that the last quantity also equals , the conclusion follows. \n  \n \n To find a nice identity, it thus suffices to find an easy domain where one can compute explicitly the brownian exit time . The first thing that comes to mind is a strip since it is classical that a Brownian motion started at takes on average to exit the strip . Since maps the unit disk to the strip it follows that \n \n which is indeed equivalent to the celebrated identity ."], "link": "http://linbaba.wordpress.com/2012/06/24/zeta-two-probabilistic-proof/", "bloglinks": {}, "links": {"http://goo.gl/": 10, "http://linbaba.wordpress.com/": 1, "http://feeds.wordpress.com/": 1}, "blogtitle": "Journey into Randomness"}, {"content": ["Consider the standard plane lattice and suppose that each point represents a city. Each city is connected to its neighbors only and each edge carries a weight that represents the time it takes to go from city to city . A natural question is the following: \n Given two (non-neighboring) cities on the map, how long does take to travel between them? \n To make the problem more tractable, mathematicians usually assume that the time it takes to travel between neighboring cities are independent from each other and identically distributed according to a distribution . In other words, each edge of the lattice carries a random variable . The random variables are and distributed according to . It takes \n \n to travel on the optimal route between city and city . The optimal route is usually called a geodesic. If one starts from the origin, one may wonder what are the cities that can be reached in less that hours, say. On the next picture, each red dot represents a city that can be reached in less than hours when the travel time between any two neighboring city is exponentially distributed with mean hour. \n  \n One may also wonder how the optimal routes look like. On the next picture I have plotted cities (the origin is the blue dotted city) and highlighted the optimal routes between the origin and each one of the cities on the border of the map. \n  \n Is it very different from the highway system around a typical city? \n \n \n \n  \n  \n \n \n \n For those who want to play with this model, you can modify the quick and dirty Python code that can be found here . The study of these models is an active area of research."], "link": "http://linbaba.wordpress.com/2011/12/19/travelling-between-cities/", "bloglinks": {}, "links": {"http://goo.gl/": 1, "http://python.org/": 1, "http://linbaba.wordpress.com/": 4, "http://feeds.wordpress.com/": 1, "http://snipt.org/": 1}, "blogtitle": "Journey into Randomness"}, {"content": ["Alexandros Marinos has just found a new solution to the Challenge 17 problem. His solution only contains 3 rectangles. This is the best solution (6 November 2011) known so far. Congratulations to Alexandros for this amazing achievement!"], "link": "http://linbaba.wordpress.com/2011/11/06/a-new-record/", "bloglinks": {}, "links": {"http://feeds.wordpress.com/": 1, "http://linbaba.wordpress.com/": 3, "http://anosognosiac.blogspot.com/": 1}, "blogtitle": "Journey into Randomness"}, {"content": ["Brownian Motion \n \nA few days ago, a student asked the following question: \n \nConsider a bounded domain and a Brownian motion conditioned to stay inside . How does it look like ? What is the invariant distribution ? \n \n \nThis is very simple, and surprisingly interesting. This involves the first eigenfunction of the Laplacian on . To make everything simple, and because this does not change anything, it suffices to study the situation where . In other words, what does a real Brownian motion conditioned to stay inside the segment look like. \n \n Discretisation \n One could directly do the computations in a continuous setting but, as it is often the case, it is simpler to consider the usual random walk discretisation of a Brownian motion. For this purpose, consider a time discretisation and a standard random walk with increment : with probability the random walk goes up and with probability it goes down . For clarity, assume that there exists an integer such that . Suppose as well that it is conditioned on the event for . Later, we will consider the limiting case and , in this order, to recover the Brownian motion case. \n \n Conditioning \n First, let us compute the probability transitions of the random walk conditioned on the event for . For clarity, let us denote the conditioned random walk by . This is a Doob h-transform , and the resulting process is a non-homogenous Markov chain. In this simple case the computations are straightforward. The conditioned Markov chain has transition probabilities given by with where . One can compute the probability that the conditioned Markov chain follows a given trajectory of , \n \n \nwhere is the transition kernel of the unconditioned Markov chain and is a normalisation constant. The Doob h-transform simply consists in noticing that this also reads \n \n \nwhere the conditioned Markov kernel is and the function is defined by \n \n \nOf course we have for all . The quantity is the probability that a random walk starting at at time remains inside for time . Consequently, in order to find the transition probabilities of the conditioned kernel, it suffices to compute the quantities for all . Since we are interested in the limiting case , it actually suffices to consider the case . It can be computed recursively since with the appropriate boundary conditions. In other words, adopting the obvious matrix notations, the vector satisfies \n \n \nwhere is the usual tridiagonal matrix given by if, and only if, and otherwise. It is related to the discrete Laplacian operator. Indeed, because all the eigenvalues of are real with modulus strictly inferior to , it follows that where is the highest eigenvalue of and the associated eigenfunction. The eigenvalues of are well-known, and as , the highest eigenvalue converges to and the associated eigenfunction converges to the first eigenfunction of the Laplacian on the domain with Dirichlet boundary . In our case it is and \n \n \nIn other words, the random walk with increments conditioned to stay inside has probability transitions given by \n \n \nNext section investigates the limiting case . \n \n Conclusion \n We have computed the dynamics of the conditioned random walk with space-increments . To obtain the dynamics of the conditioned Brownian motion it suffices to consider the limiting case . The drift of the resulting diffusion is given by\n \n The same computation gives the volatility of the resulting diffusion . It is given by\n \n As the consequence, this shows that a Brownian motion conditioned to stay inside follows the stochastic differential equation where is the first eigenfunction of the Laplacian on with Dirichlet boundary conditions . More generaly, the same argument would show that a Brownian motion in conditioned to stay inside a nice bounded domain evolves according to the stochastic differential equation\n \n where is the first eigenfunction of the Laplacian on . This is a Langevin diffusion and one can immediately see that the invariant distribution of this diffusion is given by\n \n For example, the following plot depicts the first eigenfunction of the Laplacian on the domain . \n  First Eigenfunction"], "link": "http://linbaba.wordpress.com/2011/10/25/conditioned-brownian/", "bloglinks": {}, "links": {"http://feeds.wordpress.com/": 1, "http://linbaba.wordpress.com/": 4, "http://en.wikipedia.org/": 10}, "blogtitle": "Journey into Randomness"}, {"content": ["1. Heisenberg Uncertainty Principle \n \nThe Heisenberg Uncertainty principle states that a signal cannot be both highly concentrated in time and highly concentrated in frequency. For example, consider a square-integrable function normalised so that . In this case, defines a probability distributions on the real line. The Fourier isometry shows that its Fourier transform also defines a probability distribution . In order to measure how spread-out these two probability distributions are, one can use their variance. The uncertainty principle states that\n \n where designates the variance of the distribution . This shows for example that and cannot be simultaneously less than . \n \nWe can play the same with a vector and its (discrete) Fourier transform . The Fourier matrix is defined by\n \n where the normalisation coefficient ensures that . The Fourier inversion formula reads . To measure how spread-out the coefficients of a vector are, one can look at the size of its support\n \n If an uncertainty principle holds, one should be able to bound from below. There is no universal constant such that\n \n for any and . Indeed, if and one readily checks that and so that . Nevertheless, in this case this gives . Indeed, a beautiful result of L. Donoho and B. Stark shows that \n \n Maybe more surprisingly, and crucial to applications, they even show that this principle can be made robust by taking noise and approximations into account. This is described in the next section. \n \n 2. Robust Uncertainty Principle \n Consider a subset of indices and the orthogonal projection on . In other words, if , then\n \n We say that a vector is -concentrated on if . The -robust uncertainty principle states that if is concentrated on and is -concentrated on then \n \n Indeed, the case gives Equation (5) . The proof is surprisingly easy. On introduces the reconstruction operator defined by\n \n In words: take a vector, delete the coordinate outside , take the Fourier transform, delete the coordinate outside , finally take the inverse Fourier transform. The special case simply gives . The proof consists in bounding the operator norm of from above and below. The existence of a vector that is -concentrated such that is -concentrated gives a lower bound. In details: \n \n Upper bound: it is obvious that is a contraction in the sense that since are isometries and are orthogonal projections. Moreover, the smaller and , the smaller the norm of . Since is an isometry we have , where the supremum is over all that are supported by . Cauchy-Schwarz shows that\n \n In other words, the reconstruction operator satisfies . This is a non-trivial bound only if . \n Lower bound: consider that satisfies and . The Fourier transform is an isometry so that the triangle inequality easily shows that in the sense that\n \n This proves the lower bound .\n \n \nIn summary, the reconstruction operator always satisfies . Moreover, the existence of satisfying and implies the lower bound . Therefore, the sets and must verify the uncertainty principle\n \n Notice that we have only use the fact that the entries of the Fourier matrix are bounded in absolute value by . We could have use for example any other unitary matrix . The bound for all gives the uncertainty principle . In general since is an isometry. \n \nOne can work out an upper bound and a lower bound for the reconstruction operator using the -norm instead of the -norm. Doing so, one can prove that if and then\n \n \n 3. Stable Reconstruction \n Let us see how the uncertainty principle can be used to reconstruct a corrupted signal. For example, consider a discrete signal corrupted by some noise . In top of that, let us suppose that on the set the receiver does not receive any information. In other words, the receiver can only observe\n \n In general, it is impossible to recover the original , or an approximation of it, since the data for are lost forever. In general, even if the received signal is very weak, the deleted data might be huge. Nevertheless, under the assumption that the frequencies of are supported by a set satisfying , the reconstruction becomes possible. It is not very surprising since the hypothesis implies that the signal is sufficiently smooth so that the knowledge of on is enough to construct an approximation of for . We assume that the set is known to the observer. Since the components on are not observed, one can suppose without loss of generality that there is no noise on these components ( we have for ): the observation can be described as\n \n It is possible to have a stable reconstruction of the original signal if the operator can be inverted: there exists a linear operator such that for every . If this is the case, the reconstruction\n \n satisfies so that . A sufficient condition for to exist is that for every . This is equivalent to\n \n Since for we have it follows that where is the reconstruction operator. The condition thus follows from the bound . Consequently the operator is invertible since satisfies\n \n Since we have the bound . Therefore\n \n Notice also that can easily and quickly be approximated using the expansion\n \n Nevertheless, there are two things that are not very satisfying: \n \n the bound is extremely restrictive. For example, if of the component are corrupted, this imposes that the signal has only (and not ) non-zero Fourier coefficients.\n in general, the sets and are not known by the receiver.\n \n The theory of compressed sensing addresses these two questions. More on that in forthcoming posts, hopefully \u2026 Emmanuel Candes recently gave extremely interesting lectures on compressed sensing. \n \n 4. Exact Reconstruction: Logan Phenomenon \n Let us consider a slightly different situation. A small fraction of the components of a signal are corrupted. The noise is not assumed to be small. More precisely, suppose that one observes\n \n where is the set of corrupted components and is an arbitrary noise that can potentially have very high intensity. Moreover, the set is unknown to the receiver. In general, it is indeed impossible to recover the original signal . Surprisingly, if one assumes that the signal is band-limited the Fourier transform of is supported by a known set that satisfies \n \n it is possible to recover exactly the original . The main argument is that the condition (20) implies that the signal has more that of its energy on in the sense that . Consequently, since is the set where the signal is perfectly known, enough information is available to recover the original signal . To prove the inequality , it suffices to check that\n \n In this case we have , which prove that has more that of its energy on . Indeed, the same conclusion holds with the -norm if the condition holds. The magic of the -norm is that condition implies that the signal is solution of the optimisation problem \n \n This would not be true if one were using the norm instead. This idea was first discovered in a slightly different context in Logan\u2019s thesis (1965). More details here . To prove (22) , notice that any can be written as with . Therefore, since , it suffices to show that\n \n This is equivalent to proving that for any non-zero we have\n \n It is now that the -norm is crucial. Indeed, we have\n \n which gives the conclusion. This would not work for any -norm with since in general : the inequality is in the wrong sense. In summary, as soon as the condition is satisfied, one can recover the original signal by solving the minimisation problem (22) . \n \n\\noindent Because it is not hard to check that in general we always have\n \n this shows that the condition implies that exact recovery is possible! Nevertheless, the condition is far from satisfying. The inequality is tight but in practice it happens very often that even if is much bigger that . \n \nThe take away message might be that perfect recovery is often possible if the signal has a sparse representation in an appropriate basis (in the example above, the usual Fourier Basis): the signal can then be recovered by -minimisation. For this to be possible, the representation basis (here the Fourier basis) must be incoherent with the observation basis in the sense that the coefficients of the change of basis matrix (here, Fourier matrix) must be small if is the observation basis and is the representation basis then must be small for every . For example, for the Fourier basis we have for every . \n  black: observation basis, green:representation basis"], "link": "http://linbaba.wordpress.com/2011/06/12/uncertaintyprinciple/", "bloglinks": {}, "links": {"http://feeds.wordpress.com/": 1, "http://linbaba.wordpress.com/": 5, "http://en.wikipedia.org/": 3, "http://www-stat.stanford.edu/": 2, "http://goo.gl/": 3, "http://www.berkeley.edu/": 1}, "blogtitle": "Journey into Randomness"}, {"content": ["Recently, Yann Ollivier developed a nice theory of Ricci curvature for Markov chains. In many ways, this can be seen as a geometric language giving another view on the notion of path coupling , developed at the end of the \u2018s by Martin Dyer and co-workers. It has to be noted that this new notion of curvature is very general and does not need the state space where the Markov chain evolves to have any differential structure, as can be expected at first sight. Any state space endowed with a metric suffices. \n Let be a Markov kernel on a metric state space . We would like to quantify how long it takes for two different particles evolving according to the Markovian dynamic given by to meet. If the first particle starts at and the second at , the initial distance between them is . At time , what is the average distance between these two particles. For example, if and are two Brownian motions in started from and respectively, there is no reason why and should be closer from each other than and . Indeed, one can even show that whatever the coupling of these two Brownian motions we have : this is roughly speaking because the Euclidean space has no curvature. The situation is quite different if we were instead considering Brownian motions on a sphere: in this case, trajectories tend to coalesce. \n 1. Wasserstein distance \n In the sequel, we will need to use a notion of distance between probability distributions on the metric space . The usual total variation distance defined by \n \n is not adapted to our purpose since the metric structure of the space is not exploited. Instead, in order to take into account the distance of the space and develop a notion of curvature, we use the Wasserstein distance between probability measures. It is defined as \n \n The distance is crucial to this definition: a change of distance implies a change of the class of -Lipschitz functions. Since for any coupling of and , and since the function is -Lipschitz, it follows that . Consequently, for any coupling we have . Taking the infimum over all the couplings leads to the inequality \n \n This is a deep result that on any reasonable space the inequality is in fact an equality. Indeed, Kantorovich duality states that on any Radon space we have \n \n  \n  \n It is interesting to note that under mild conditions on the state space one can always find a coupling that achieves the infimum of (4) : this is an easy compactness argument. \n 2. Notion of Curvature \n Denoting by the one step distribution of the Markov chain started from in the sense that , we define the local (Ricci) curvature between and as \n \n  \n  \n The closer to is , the more the trajectories started at tend to meet the trajectories started at . \n  Trajectories tend to coalesce \n The interesting case is when the infimum is strictly positive, \n \n  \n  \n In this case we say that the Markov kernel is positively curved on . It should be noted that in many natural spaces it suffices to ensure that for all neighbouring states and to ensure that for any pair . This can be proved thanks to the so called Gluing Lemma. A space without curvature correspond to the case : for example, a symmetric random walk on and a Brownian motion on have both zero curvature. The curvature is a property of both the metric space and the Markov kernel : indeed, different Markov chain on the same metric space have generally different associated curvature. Given a metric space carrying a probability distribution , this is an interesting problem to construct a -invariant Markov chain with the highest possible curvature . \n Indeed, the notion of curvature readily generalizes to continuous time Markov processes by taking a limiting case of (5) . For example, one can define the curvature of the continuous time Markov process as the largest real number such that for any and we have \n \n for every small enough. The quantity is the distribution of when started from in the sense that . \n 3. Contraction property \n We now show that a positive curvature implies a contraction property. Equation (5) shows that for any . A simple argument shows that one can indeed generalize the situation to any two distributions in the sense that \n \n  \n  \n  Proof: For any pair consider a coupling of and such that . Now, choose an optimal coupling of and . This is straightforward to check that is a coupling (in general not optimal) of and so that \n \n \n Equation (8) is extremely powerful since it immediately shows that \n \n In other words, there is exponential convergence (in the Wasserstein metric) to the invariance distribution at rate . In continuous time, this reads \n \n In other words, the higher the curvature, the faster the convergence to equilibrium. \n 4. Examples \n Let us give examples of positively curved Markov chains. \n \n Langevin diffusion with convex potential: consider a convex potential that is uniformly elliptic in the sense . The Langevin diffusion has invariant distribution with density proportional to . Given a time step , the Euler discretization of this diffusion reads \n \n where . Given two starting points and , using the same noise to define and it immediately follows that \n \n In other words, the Langevin diffusion is positively curved with curvature (at least) equal to . \n \n Brownian motion on a sphere : consider a Brownian motion on the unit sphere of . Consider two points on this unit sphere: by symmetry, one can always rotate the coordinates so that that and for some . For the (geodesic) distance is approximated by . One can couple two Brownian motions and , one started at and the other one started at , by the usual symmetry with respect to the plane : in other words, is the reflexion of with respect to . One can check (good exercise!) that the diffusion followed by the -coordinate of a Brownian motion on the unit sphere of is simply given by \n \n With this coupling, for small time , it follows that \n \n where is used as the same source of randomness for and since is the reflexion of . Since it readily follows that \n \n In other words, the curvature of a Brownian motion on the unit sphere of is equal to . Maybe surprisingly, the higher the dimension, the faster the convergence to equilibrium. This is not so unreal if one notices that the Brownian increment satisfies . \n Other examples : see the original text for many other examples."], "link": "http://linbaba.wordpress.com/2011/03/21/curvature/", "bloglinks": {}, "links": {"http://feeds.wordpress.com/": 1, "http://scholar.co.uk/": 1, "http://www.ac.uk/": 1, "http://linbaba.wordpress.com/": 5, "http://www.yann-ollivier.org/": 2, "http://en.wikipedia.org/": 4}, "blogtitle": "Journey into Randomness"}, {"content": ["Yesterday, while reading the last issue of the NewScientist , I came across the following very cute riddle : \n \n \n \nLazy, I asked myself if it were possible to write lines long Python code to solve this innocent looking enigma. The whole pyramid is entirely determined by the numbers lying at the bottom, and each one of them is an integer between and : these numbers must be different so that there are at most possibilities to test! Brute force won\u2019t work my friend! \n \nWhen stupid brute force does not work, one can still try annealing/probabilist methods: this works pretty well for Sudoku (which is NP-hard) as this is brilliantly described here and there . The principle is simple: if one can find a good energy function such that a solution to the problem corresponds to a low energy configuration, one can do MCMC-simulating annealing-etc on the target distribution\n \n The issue is that it might be very difficult to choose a sensible energy function . Foolishly, I first tried the following energy function, and then ran a random walk Metropolis algorithm with as target probability:\n \n where is the numbers of levels that one can fill, starting from the bottom, without encountering any problem no repetition and no number greater than . With different values of and letting run the algorithm for a few millions iterations ( min on my crappy laptop), one can easily produce configurations that are -levels high: but the algorithm never found any real solution a configuration with height equal to . \n \nNow I am curious wether this is possible to produce a non-stupid energy function so that this riddle is solvable in a reasonable amount of time by standard MCMC \u2013 annealing methods. \n \nAs a conclusion, I should mention that with a pen and a cup of coffee, one can easily find a solution: I will not spoil the fun, but just say that the configuration space is not that big if one think more carefully about it\u2026"], "link": "http://linbaba.wordpress.com/2011/01/30/joes-pyramid/", "bloglinks": {}, "links": {"http://xianblog.wordpress.com/": 1, "http://www.newscientist.com/": 2, "http://www.python.org/": 1, "http://linbaba.wordpress.com/": 1, "http://en.wikipedia.org/": 1, "http://feeds.wordpress.com/": 1, "http://healthyalgorithms.wordpress.com/": 1}, "blogtitle": "Journey into Randomness"}, {"content": ["In many situations it might be useful to know how to sample a Markov chain (or a diffusion process) between time and , conditioned on the knowledge that and . This conditioned Markov chain is still a Markov chain but in general is not time homogeneous. Moreover, it is generally very difficult to compute the transition probabilities of this conditioned Markov chain since they depend on the knowledge of the transition probabilities of the unconditioned Markov chain, which are usually not available: this has been discussed in this previous post on Doob h-transforms. Perhaps surprisingly, this article by Michael Sorensen and Mogens Bladt shows how this is sometimes quite easy to sample good approximations of such a conditioned Markov chain, or diffusion. \n 1. Reversible Markov chains \n Remember that a Markov chain on the state space with transition operator is reversible with respect to the probability if for any \n \n In words, this means that looking at a trajectory of this Markov chain, this is impossible to say if the time is running forward or backward: indeed, the probability of observing is equal to , which is also equal to if the chain is reversible. \n This is precisely this property of invariance by time reversal that allows to sample from conditioned reversible Markov chain. Since under mild conditions a one dimensional diffusion is also reversible, this also shows that (ergodic) one dimensional conditioned diffusions are sometimes quite easy to sample from! \n 2. One dimensional diffusions are reversible! \n The other someone told me that almost any one dimensional diffusion is reversible! I did not know that, and I must admit that I still find this result rather surprising. Indeed, this is not true for multidimensional diffusions, and this is very easy to construct counter-examples. What makes the result works for real diffusions is that there is only one way to go from to , namely the segment . Indeed, the situation is completely different in higher dimensions. \n First, let us remark that any Markov chain on , that has as invariant distribution and that can only make jumps of size or is reversible: such a Markov chain is usually called skip-free in the litterature. This is extremely easy to prove, and since skip-free Markov chains have been studied a lot, I am sure that this result is somewhere in the litterature (any reference for that?). To show the result, it suffices to show that for any where is the upward flux at level and is the downward flux. Because is invariant it satisfies the usual balance equations , \n \n so that . Interating we get that for any we have : the conclusion follows since . \n This simple result on skip-free Markov chains gives also the result for many one dimensional diffusions since under regularity assumptions on and they can be seen as limit of skip-free one dimensional Markov chains on . Indeed, I guess that the usual proof of this result goes through introducing the scale function and the speed measure of the diffusion, but I would be very glad if anyone had another pedestrian approach that gives more intuition into this. \n 3. How to sample conditioned reversible Markov chains \n From what has been said before, I am sure that this becomes quite clear how a conditioned reversible Markov chain can be sampled from. Suppose that is reversible Markov chain and that we would like to sample a path conditioned on the event and : \n \n sample the path between and , starting from \n sample the path between and , starting from \n if there exists such that then define the path by and otherwise go back to step . \n \n Indeed, the resulting path is an approximation of the realisation of the conditioned Markov chain: this is not hard to prove it, playing around with the definition of time reversibility. It is not hard at all to adapt this idea to reversible diffusions, though the result is indeed again an approximation. The interesting question is to discuss how good this approximation is (see the paper by Michael Sorensen and Mogens Bladt ) \n For example, here is a sample from a Birth-Death process, conditioned on the event and , with parameter . \n  Conditioned Birth-Death process \n 4. Final remark \n It might be interesting to notice that this method is especially inefficent for multidimensional processes: the probability of finding an instant such that is extremely small, and in many cases equal to for diffusions! This works pretty well for one dimensional diffusion thanks to the continuity of the path and the intermediate value property. Nevertheless, even for one dimensional diffusion this method does not work well at all when trying to sample from conditioned paths between two meta-stable position: this is precisely this situation that is interesting in many physics when one wants to study the evolution of a particle in a double well potential, for example. In short, sampling conditioned (multidimensional) diffusions is still a very difficult problem."], "link": "http://linbaba.wordpress.com/2010/11/07/sampling-conditioned-markov-chain-and-diffusions/", "bloglinks": {}, "links": {"http://www.unam.mx/": 1, "http://feeds.wordpress.com/": 1, "http://linbaba.wordpress.com/": 3, "http://www.ku.dk/": 1, "http://en.wikipedia.org/": 4}, "blogtitle": "Journey into Randomness"}]